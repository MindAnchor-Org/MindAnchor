{
  "version": 3,
  "sources": ["../../svelte/src/reactivity/utils.js", "../../svelte/src/reactivity/create-subscriber.js", "../../svelte/src/reactivity/reactive-value.js", "../../svelte/src/reactivity/window/index.js"],
  "sourcesContent": ["/** @import { Source } from '#client' */\r\nimport { set } from '../internal/client/reactivity/sources.js';\r\n\r\n/** @param {Source<number>} source */\r\nexport function increment(source) {\r\n\tset(source, source.v + 1);\r\n}\r\n", "import { get, tick, untrack } from '../internal/client/runtime.js';\r\nimport { effect_tracking, render_effect } from '../internal/client/reactivity/effects.js';\r\nimport { source } from '../internal/client/reactivity/sources.js';\r\nimport { increment } from './utils.js';\r\n\r\n/**\r\n * Returns a `subscribe` function that, if called in an effect (including expressions in the template),\r\n * calls its `start` callback with an `update` function. Whenever `update` is called, the effect re-runs.\r\n *\r\n * If `start` returns a function, it will be called when the effect is destroyed.\r\n *\r\n * If `subscribe` is called in multiple effects, `start` will only be called once as long as the effects\r\n * are active, and the returned teardown function will only be called when all effects are destroyed.\r\n *\r\n * It's best understood with an example. Here's an implementation of [`MediaQuery`](https://svelte.dev/docs/svelte/svelte-reactivity#MediaQuery):\r\n *\r\n * ```js\r\n * import { createSubscriber } from 'svelte/reactivity';\r\n * import { on } from 'svelte/events';\r\n *\r\n * export class MediaQuery {\r\n * \t#query;\r\n * \t#subscribe;\r\n *\r\n * \tconstructor(query) {\r\n * \t\tthis.#query = window.matchMedia(`(${query})`);\r\n *\r\n * \t\tthis.#subscribe = createSubscriber((update) => {\r\n * \t\t\t// when the `change` event occurs, re-run any effects that read `this.current`\r\n * \t\t\tconst off = on(this.#query, 'change', update);\r\n *\r\n * \t\t\t// stop listening when all the effects are destroyed\r\n * \t\t\treturn () => off();\r\n * \t\t});\r\n * \t}\r\n *\r\n * \tget current() {\r\n * \t\tthis.#subscribe();\r\n *\r\n * \t\t// Return the current state of the query, whether or not we're in an effect\r\n * \t\treturn this.#query.matches;\r\n * \t}\r\n * }\r\n * ```\r\n * @param {(update: () => void) => (() => void) | void} start\r\n * @since 5.7.0\r\n */\r\nexport function createSubscriber(start) {\r\n\tlet subscribers = 0;\r\n\tlet version = source(0);\r\n\t/** @type {(() => void) | void} */\r\n\tlet stop;\r\n\r\n\treturn () => {\r\n\t\tif (effect_tracking()) {\r\n\t\t\tget(version);\r\n\r\n\t\t\trender_effect(() => {\r\n\t\t\t\tif (subscribers === 0) {\r\n\t\t\t\t\tstop = untrack(() => start(() => increment(version)));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsubscribers += 1;\r\n\r\n\t\t\t\treturn () => {\r\n\t\t\t\t\ttick().then(() => {\r\n\t\t\t\t\t\t// Only count down after timeout, else we would reach 0 before our own render effect reruns,\r\n\t\t\t\t\t\t// but reach 1 again when the tick callback of the prior teardown runs. That would mean we\r\n\t\t\t\t\t\t// re-subcribe unnecessarily and create a memory leak because the old subscription is never cleaned up.\r\n\t\t\t\t\t\tsubscribers -= 1;\r\n\r\n\t\t\t\t\t\tif (subscribers === 0) {\r\n\t\t\t\t\t\t\tstop?.();\r\n\t\t\t\t\t\t\tstop = undefined;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n}\r\n", "import { createSubscriber } from './create-subscriber.js';\r\n\r\n/**\r\n * @template T\r\n */\r\nexport class ReactiveValue {\r\n\t#fn;\r\n\t#subscribe;\r\n\r\n\t/**\r\n\t *\r\n\t * @param {() => T} fn\r\n\t * @param {(update: () => void) => void} onsubscribe\r\n\t */\r\n\tconstructor(fn, onsubscribe) {\r\n\t\tthis.#fn = fn;\r\n\t\tthis.#subscribe = createSubscriber(onsubscribe);\r\n\t}\r\n\r\n\tget current() {\r\n\t\tthis.#subscribe();\r\n\t\treturn this.#fn();\r\n\t}\r\n}\r\n", "import { BROWSER } from 'esm-env';\r\nimport { on } from '../../events/index.js';\r\nimport { ReactiveValue } from '../reactive-value.js';\r\nimport { get } from '../../internal/client/index.js';\r\nimport { set, source } from '../../internal/client/reactivity/sources.js';\r\n\r\n/**\r\n * `scrollX.current` is a reactive view of `window.scrollX`. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const scrollX = new ReactiveValue(\r\n\tBROWSER ? () => window.scrollX : () => undefined,\r\n\t(update) => on(window, 'scroll', update)\r\n);\r\n\r\n/**\r\n * `scrollY.current` is a reactive view of `window.scrollY`. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const scrollY = new ReactiveValue(\r\n\tBROWSER ? () => window.scrollY : () => undefined,\r\n\t(update) => on(window, 'scroll', update)\r\n);\r\n\r\n/**\r\n * `innerWidth.current` is a reactive view of `window.innerWidth`. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const innerWidth = new ReactiveValue(\r\n\tBROWSER ? () => window.innerWidth : () => undefined,\r\n\t(update) => on(window, 'resize', update)\r\n);\r\n\r\n/**\r\n * `innerHeight.current` is a reactive view of `window.innerHeight`. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const innerHeight = new ReactiveValue(\r\n\tBROWSER ? () => window.innerHeight : () => undefined,\r\n\t(update) => on(window, 'resize', update)\r\n);\r\n\r\n/**\r\n * `outerWidth.current` is a reactive view of `window.outerWidth`. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const outerWidth = new ReactiveValue(\r\n\tBROWSER ? () => window.outerWidth : () => undefined,\r\n\t(update) => on(window, 'resize', update)\r\n);\r\n\r\n/**\r\n * `outerHeight.current` is a reactive view of `window.outerHeight`. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const outerHeight = new ReactiveValue(\r\n\tBROWSER ? () => window.outerHeight : () => undefined,\r\n\t(update) => on(window, 'resize', update)\r\n);\r\n\r\n/**\r\n * `screenLeft.current` is a reactive view of `window.screenLeft`. It is updated inside a `requestAnimationFrame` callback. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const screenLeft = new ReactiveValue(\r\n\tBROWSER ? () => window.screenLeft : () => undefined,\r\n\t(update) => {\r\n\t\tlet value = window.screenLeft;\r\n\r\n\t\tlet frame = requestAnimationFrame(function check() {\r\n\t\t\tframe = requestAnimationFrame(check);\r\n\r\n\t\t\tif (value !== (value = window.screenLeft)) {\r\n\t\t\t\tupdate();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn () => {\r\n\t\t\tcancelAnimationFrame(frame);\r\n\t\t};\r\n\t}\r\n);\r\n\r\n/**\r\n * `screenTop.current` is a reactive view of `window.screenTop`. It is updated inside a `requestAnimationFrame` callback. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const screenTop = new ReactiveValue(\r\n\tBROWSER ? () => window.screenTop : () => undefined,\r\n\t(update) => {\r\n\t\tlet value = window.screenTop;\r\n\r\n\t\tlet frame = requestAnimationFrame(function check() {\r\n\t\t\tframe = requestAnimationFrame(check);\r\n\r\n\t\t\tif (value !== (value = window.screenTop)) {\r\n\t\t\t\tupdate();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn () => {\r\n\t\t\tcancelAnimationFrame(frame);\r\n\t\t};\r\n\t}\r\n);\r\n\r\n/**\r\n * `online.current` is a reactive view of `navigator.onLine`. On the server it is `undefined`.\r\n * @since 5.11.0\r\n */\r\nexport const online = new ReactiveValue(\r\n\tBROWSER ? () => navigator.onLine : () => undefined,\r\n\t(update) => {\r\n\t\tconst unsub_online = on(window, 'online', update);\r\n\t\tconst unsub_offline = on(window, 'offline', update);\r\n\t\treturn () => {\r\n\t\t\tunsub_online();\r\n\t\t\tunsub_offline();\r\n\t\t};\r\n\t}\r\n);\r\n\r\n/**\r\n * `devicePixelRatio.current` is a reactive view of `window.devicePixelRatio`. On the server it is `undefined`.\r\n * Note that behaviour differs between browsers â€” on Chrome it will respond to the current zoom level,\r\n * on Firefox and Safari it won't.\r\n * @type {{ get current(): number | undefined }}\r\n * @since 5.11.0\r\n */\r\nexport const devicePixelRatio = /* @__PURE__ */ new (class DevicePixelRatio {\r\n\t#dpr = source(BROWSER ? window.devicePixelRatio : undefined);\r\n\r\n\t#update() {\r\n\t\tconst off = on(\r\n\t\t\twindow.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),\r\n\t\t\t'change',\r\n\t\t\t() => {\r\n\t\t\t\tset(this.#dpr, window.devicePixelRatio);\r\n\r\n\t\t\t\toff();\r\n\t\t\t\tthis.#update();\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tif (BROWSER) {\r\n\t\t\tthis.#update();\r\n\t\t}\r\n\t}\r\n\r\n\tget current() {\r\n\t\tget(this.#dpr);\r\n\t\treturn BROWSER ? window.devicePixelRatio : undefined;\r\n\t}\r\n})();\r\n"],
  "mappings": "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",
  "names": ["source"]
}
